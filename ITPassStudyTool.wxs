<?xml version="1.0" encoding="utf-8"?>
<!-- WiX Toolset MSI インストーラー定義 -->
<!-- 日本語対応、完全なショートカット機能付き -->
<!-- 
対応: WiX v4+, WiX v6+
用法: wix build this.wxs -o output.msi
-->
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package Name="ITパスポート試験学習ツール"
           Language="1041"
           Version="1.0.0.0"
           Manufacturer="ITPassStudyTool"
           UpgradeCode="5A8B4C2D-3E6F-4A2B-8C9D-7E1F5A3B6C9D"
           InstallerVersion="200"
           Compressed="yes"
           Scope="perMachine">

    <MajorUpgrade DowngradeErrorMessage="より新しいバージョンが既にインストールされています。" />
    <MediaTemplate EmbedCab="yes" />

    <StandardDirectory Id="ProgramFilesFolder">
      <Directory Id="INSTALLFOLDER" Name="ITPassStudyTool">
        <Component Id="MainExecutable" Guid="*">
          <File Id="MainEXE" Name="it-pass-study-tool.exe"
                Source="dist\it-pass-study-tool.exe"
                KeyPath="yes" />
        </Component>
      </Directory>
    </StandardDirectory>

    <StandardDirectory Id="DesktopFolder">
      <Component Id="DesktopShortcutComp" Guid="*">
        <Shortcut Id="DesktopShortcut"
                  Name="ITパスポート試験学習ツール"
                  Target="[INSTALLFOLDER]it-pass-study-tool.exe"
                  WorkingDirectory="INSTALLFOLDER" />
        <RegistryValue Root="HKCU" Key="Software\ITPassStudyTool"
                       Name="DesktopShortcut" Type="string" Value="1" KeyPath="yes" />
      </Component>
    </StandardDirectory>

    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="MENUFOLDER" Name="ITパスポート試験学習ツール">
        <Component Id="MenuShortcutComp" Guid="*">
          <Shortcut Id="MenuShortcut"
                    Name="ITパスポート試験学習ツール"
                    Target="[INSTALLFOLDER]it-pass-study-tool.exe"
                    WorkingDirectory="INSTALLFOLDER" />
          <RemoveFolder Id="RemoveMenuFolder" On="uninstall" />
          <RegistryValue Root="HKCU" Key="Software\ITPassStudyTool"
                         Name="MenuShortcut" Type="string" Value="1" KeyPath="yes" />
        </Component>
      </Directory>
    </StandardDirectory>

    <Feature Id="ProductFeature" Title="ITパスポート試験学習ツール" Level="1">
      <ComponentRef Id="MainExecutable" />
      <ComponentRef Id="DesktopShortcutComp" />
      <ComponentRef Id="MenuShortcutComp" />
    </Feature>

  </Package>
</Wix>
